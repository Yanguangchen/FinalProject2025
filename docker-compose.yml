services:
  expo:
    build:
      context: .
    ports:
      - "19000:19000" # Metro
      - "19001:19001" # Metro (legacy)
      - "19002:19002" # Expo DevTools
      - "19006:19006" # Web (when using --web)
      - "8081:8081"   # Metro (RN)
    environment:
      # Reliable file watching in containers
      - CHOKIDAR_USEPOLLING=true
      - WATCHPACK_POLLING=true
      # Make DevTools reachable outside the container
      - EXPO_DEVTOOLS_LISTEN_ADDRESS=0.0.0.0
    volumes:
      - .:/app
      - node_modules:/app/node_modules
    command: ["npx", "expo", "start", "--clear", "--non-interactive", "--lan", "--port", "19000"]

volumes:
  node_modules:
